2022-11-19 20:15:51.540 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7145/api/Car - -
2022-11-19 20:15:51.561 +01:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '16/11/2022 19:35:18', Current time: '19/11/2022 19:15:51'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateJWS(String token, TokenValidationParameters validationParameters, BaseConfiguration currentConfiguration, SecurityToken& signatureValidatedToken, ExceptionDispatchInfo& exceptionThrown)
--- End of stack trace from previous location ---
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, JwtSecurityToken outerToken, TokenValidationParameters validationParameters, SecurityToken& signatureValidatedToken)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleAuthenticateAsync()
2022-11-19 20:15:51.623 +01:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '16/11/2022 19:35:18', Current time: '19/11/2022 19:15:51'.
2022-11-19 20:15:51.624 +01:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User|Admin)
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2022-11-19 20:15:51.635 +01:00 [INF] AuthenticationScheme: Bearer was challenged.
2022-11-19 20:15:51.636 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7145/api/Car - - - 401 0 - 97.0967ms
2022-11-19 20:16:00.786 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7145/api/Auth/Refresh?token=58g28%2BDo8LwesiB5Tezqpn%2BnWqJ%2BcJ0bSxc0iUWYuu4%3D - 0
2022-11-19 20:16:00.788 +01:00 [INF] CORS policy execution successful.
2022-11-19 20:16:00.788 +01:00 [INF] Executing endpoint 'CarDealer.Controllers.AuthController.GetRefreshToken (CarDealer)'
2022-11-19 20:16:00.790 +01:00 [INF] Route matched with {action = "GetRefreshToken", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshToken(System.String) on controller CarDealer.Controllers.AuthController (CarDealer).
2022-11-19 20:16:00.863 +01:00 [INF] Entity Framework Core 6.0.10 initialized 'DataContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.10' with options: None
2022-11-19 20:16:00.870 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[FirstName], [u].[LastName], [u].[PasswordHash], [u].[PasswordSalt], [u].[RefreshToken], [u].[Role], [u].[TokenCreated], [u].[TokenExpires], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[RefreshToken] = @__token_0
2022-11-19 20:16:00.873 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p3='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [RefreshToken] = @p0, [TokenCreated] = @p1, [TokenExpires] = @p2
WHERE [Id] = @p3;
SELECT @@ROWCOUNT;
2022-11-19 20:16:00.874 +01:00 [INF] Executing OkObjectResult, writing value of type 'CarDealer.Models.Token'.
2022-11-19 20:16:00.874 +01:00 [INF] Executed action CarDealer.Controllers.AuthController.GetRefreshToken (CarDealer) in 83.9431ms
2022-11-19 20:16:00.874 +01:00 [INF] Executed endpoint 'CarDealer.Controllers.AuthController.GetRefreshToken (CarDealer)'
2022-11-19 20:16:00.874 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7145/api/Auth/Refresh?token=58g28%2BDo8LwesiB5Tezqpn%2BnWqJ%2BcJ0bSxc0iUWYuu4%3D - 0 - 200 - application/json;+charset=utf-8 88.1030ms
2022-11-19 20:16:13.078 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7145/api/Car - -
2022-11-19 20:16:13.079 +01:00 [INF] Executing endpoint 'CarDealer.Controllers.CarController.GetAll (CarDealer)'
2022-11-19 20:16:13.079 +01:00 [INF] Route matched with {action = "GetAll", controller = "Car"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAll() on controller CarDealer.Controllers.CarController (CarDealer).
2022-11-19 20:16:13.080 +01:00 [INF] Entity Framework Core 6.0.10 initialized 'DataContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.10' with options: None
2022-11-19 20:16:13.082 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CarManufacturerId], [c].[CarType], [c].[Hp], [c].[Make], [c].[Model], [c].[Seats], [c].[Year]
FROM [Cars] AS [c]
2022-11-19 20:16:13.082 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarDealer.Domain.Car.GetCarDto, CarDealer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-11-19 20:16:13.082 +01:00 [INF] Executed action CarDealer.Controllers.CarController.GetAll (CarDealer) in 2.8173ms
2022-11-19 20:16:13.082 +01:00 [INF] Executed endpoint 'CarDealer.Controllers.CarController.GetAll (CarDealer)'
2022-11-19 20:16:13.082 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7145/api/Car - - - 200 - application/json;+charset=utf-8 4.6177ms
2022-11-19 20:16:22.318 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7145/api/Auth/Refresh?token=KdyDiOB7z1YTkjIUSNzsakytcsqeZy3H7mWtTwqyOok%3D - 0
2022-11-19 20:16:22.318 +01:00 [INF] CORS policy execution successful.
2022-11-19 20:16:22.318 +01:00 [INF] Executing endpoint 'CarDealer.Controllers.AuthController.GetRefreshToken (CarDealer)'
2022-11-19 20:16:22.318 +01:00 [INF] Route matched with {action = "GetRefreshToken", controller = "Auth"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshToken(System.String) on controller CarDealer.Controllers.AuthController (CarDealer).
2022-11-19 20:16:22.321 +01:00 [INF] Entity Framework Core 6.0.10 initialized 'DataContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.10' with options: None
2022-11-19 20:16:22.326 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[Email], [u].[FirstName], [u].[LastName], [u].[PasswordHash], [u].[PasswordSalt], [u].[RefreshToken], [u].[Role], [u].[TokenCreated], [u].[TokenExpires], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[RefreshToken] = @__token_0
2022-11-19 20:16:22.328 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[@p3='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Users] SET [RefreshToken] = @p0, [TokenCreated] = @p1, [TokenExpires] = @p2
WHERE [Id] = @p3;
SELECT @@ROWCOUNT;
2022-11-19 20:16:22.329 +01:00 [INF] Executing OkObjectResult, writing value of type 'CarDealer.Models.Token'.
2022-11-19 20:16:22.329 +01:00 [INF] Executed action CarDealer.Controllers.AuthController.GetRefreshToken (CarDealer) in 10.5919ms
2022-11-19 20:16:22.329 +01:00 [INF] Executed endpoint 'CarDealer.Controllers.AuthController.GetRefreshToken (CarDealer)'
2022-11-19 20:16:22.329 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7145/api/Auth/Refresh?token=KdyDiOB7z1YTkjIUSNzsakytcsqeZy3H7mWtTwqyOok%3D - 0 - 200 - application/json;+charset=utf-8 11.1024ms
2022-11-19 20:16:38.599 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7145/api/Car - -
2022-11-19 20:16:38.600 +01:00 [INF] Executing endpoint 'CarDealer.Controllers.CarController.GetAll (CarDealer)'
2022-11-19 20:16:38.601 +01:00 [INF] Route matched with {action = "GetAll", controller = "Car"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAll() on controller CarDealer.Controllers.CarController (CarDealer).
2022-11-19 20:16:38.602 +01:00 [INF] Entity Framework Core 6.0.10 initialized 'DataContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:6.0.10' with options: None
2022-11-19 20:16:38.604 +01:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CarManufacturerId], [c].[CarType], [c].[Hp], [c].[Make], [c].[Model], [c].[Seats], [c].[Year]
FROM [Cars] AS [c]
2022-11-19 20:16:38.604 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarDealer.Domain.Car.GetCarDto, CarDealer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-11-19 20:16:38.604 +01:00 [INF] Executed action CarDealer.Controllers.CarController.GetAll (CarDealer) in 3.6879ms
2022-11-19 20:16:38.604 +01:00 [INF] Executed endpoint 'CarDealer.Controllers.CarController.GetAll (CarDealer)'
2022-11-19 20:16:38.604 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7145/api/Car - - - 200 - application/json;+charset=utf-8 5.4367ms
